<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      const json = {
        code: 1,
        data: {
          testData: {
            fitUses: [],
            isLastMonthOfQuarter: false,
            signingAmounts: {
              1302: 416037,
              1304: 173103,
            },
            materialsAmounts: {
              1302: 0,
              1304: 242420,
            },
            source: [
              {
                id: 16639,
                number: "SK250214156952601",
                targetId: 3243,
                type: 304,
                kind: 149,
                adminId: 1302,
                auditor: 1302,
                sendId: null,
                amount: 244237.71,
                data: {
                  associatedMaterials: [
                    {
                      id: 31019,
                      amount: 242420,
                    },
                    {
                      id: 31020,
                      amount: 1785.71,
                    },
                    {
                      id: 31021,
                      amount: 1,
                    },
                    {
                      id: 31022,
                      amount: 16,
                    },
                    {
                      id: 31023,
                      amount: 1,
                    },
                    {
                      id: 31024,
                      amount: 14,
                    },
                  ],
                },
                time: "2025-02-14T01:18:00.000Z",
                date: null,
                status: 2,
                remarks: "1",
                createdAt: "2025-02-14T01:17:57.000Z",
                updatedAt: "2025-02-14T01:18:00.000Z",
                payments: [],
                refundMaterials: [],
              },
              {
                id: 16647,
                number: "SK250214133052163",
                targetId: 3247,
                type: 304,
                kind: 149,
                adminId: 1302,
                auditor: 1302,
                sendId: null,
                amount: 260287.1,
                data: {
                  associatedMaterials: [
                    {
                      id: 31067,
                      amount: 242420,
                    },
                    {
                      id: 31068,
                      amount: 10,
                    },
                    {
                      id: 31069,
                      amount: 17857.1,
                    },
                  ],
                },
                time: "2025-02-14T03:09:28.000Z",
                date: null,
                status: 2,
                remarks: "11",
                createdAt: "2025-02-14T03:08:59.000Z",
                updatedAt: "2025-02-14T03:09:28.000Z",
                payments: [],
                refundMaterials: [],
              },
              {
                id: 16722,
                number: "SK250219147153704",
                targetId: 3254,
                type: 304,
                kind: 149,
                adminId: 1302,
                auditor: 1302,
                sendId: null,
                amount: 10,
                data: {
                  associatedMaterials: [
                    {
                      id: 31169,
                      amount: 10,
                    },
                  ],
                },
                time: "2025-02-19T07:42:52.000Z",
                date: null,
                status: 2,
                remarks: "1",
                createdAt: "2025-02-19T07:42:48.000Z",
                updatedAt: "2025-02-19T07:42:52.000Z",
                payments: [],
                refundMaterials: [],
              },
              {
                id: 16723,
                number: "SK250219168317117",
                targetId: 3254,
                type: 304,
                kind: 149,
                adminId: 1302,
                auditor: 1302,
                sendId: null,
                amount: 140,
                data: {
                  associatedMaterials: [
                    {
                      id: 31170,
                      amount: 140,
                    },
                  ],
                },
                time: "2025-02-19T08:10:22.000Z",
                date: null,
                status: 2,
                remarks: "1",
                createdAt: "2025-02-19T08:05:52.000Z",
                updatedAt: "2025-02-19T08:10:22.000Z",
                payments: [],
                refundMaterials: [],
              },
              {
                id: 16724,
                number: "SK250219133293427",
                targetId: 3254,
                type: 304,
                kind: 149,
                adminId: 1302,
                auditor: 1302,
                sendId: null,
                amount: 242420,
                data: {
                  associatedMaterials: [
                    {
                      id: 31171,
                      amount: 242420,
                    },
                  ],
                },
                time: "2025-02-19T08:11:49.000Z",
                date: null,
                status: 2,
                remarks: "1",
                createdAt: "2025-02-19T08:11:45.000Z",
                updatedAt: "2025-02-19T08:11:49.000Z",
                payments: [],
                refundMaterials: [],
              },
              {
                id: 18079,
                number: "SK250423187300089",
                targetId: 3266,
                type: 304,
                kind: 149,
                adminId: 1304,
                auditor: 1304,
                sendId: null,
                amount: 1,
                data: {
                  associatedMaterials: [
                    {
                      id: 31366,
                      amount: 1,
                    },
                  ],
                  receiveType: 2,
                },
                time: "2025-04-23T09:08:04.000Z",
                date: null,
                status: 2,
                remarks: "1",
                createdAt: "2025-04-23T09:08:01.000Z",
                updatedAt: "2025-04-23T09:08:04.000Z",
                payments: [],
                refundMaterials: [],
              },
              {
                id: 18080,
                number: "SK250423187930459",
                targetId: 3266,
                type: 304,
                kind: 149,
                adminId: 1304,
                auditor: 1304,
                sendId: null,
                amount: 242420,
                data: {
                  associatedMaterials: [
                    {
                      id: 31367,
                      amount: 242420,
                    },
                  ],
                  receiveType: 2,
                },
                time: "2025-04-23T09:09:03.000Z",
                date: null,
                status: 2,
                remarks: "1",
                createdAt: "2025-04-23T09:09:00.000Z",
                updatedAt: "2025-04-23T09:09:03.000Z",
                payments: [
                  {
                    id: 119,
                    refundBillId: 18081,
                    paymentBillId: 18080,
                    refundAmount: 197763.68,
                  },
                ],
                refundMaterials: [
                  {
                    id: 891,
                    type: 2,
                    amount: 197763.68,
                    billId: 18081,
                    materialId: 31367,
                  },
                ],
              },
            ],
            bills: {
              3243: {
                paymentAmount: 244237.71,
                refundAmount: 0,
                payments: {
                  304: 244237.71,
                },
                refunds: {},
                types: {
                  304: [
                    {
                      id: 16639,
                      amount: 244237.71,
                      payments: [],
                      refundMaterials: [],
                    },
                  ],
                },
              },
              3247: {
                paymentAmount: 260287.1,
                refundAmount: 0,
                payments: {
                  304: 260287.1,
                },
                refunds: {},
                types: {
                  304: [
                    {
                      id: 16647,
                      amount: 260287.1,
                      payments: [],
                      refundMaterials: [],
                    },
                  ],
                },
              },
              3254: {
                paymentAmount: 242570,
                refundAmount: 0,
                payments: {
                  304: 242570,
                },
                refunds: {},
                types: {
                  304: [
                    {
                      id: 16722,
                      amount: 10,
                      payments: [],
                      refundMaterials: [],
                    },
                    {
                      id: 16723,
                      amount: 140,
                      payments: [],
                      refundMaterials: [],
                    },
                    {
                      id: 16724,
                      amount: 242420,
                      payments: [],
                      refundMaterials: [],
                    },
                  ],
                },
              },
              3266: {
                paymentAmount: 242421,
                refundAmount: 197763.68,
                payments: {
                  304: 242421,
                },
                refunds: {
                  304: 197763.68,
                },
                types: {
                  304: [
                    {
                      id: 18079,
                      amount: 1,
                      payments: [],
                      refundMaterials: [],
                    },
                    {
                      id: 18080,
                      amount: 242420,
                      payments: [
                        {
                          id: 119,
                          refundBillId: 18081,
                          paymentBillId: 18080,
                          refundAmount: 197763.68,
                        },
                      ],
                      refundMaterials: [
                        {
                          id: 891,
                          type: 2,
                          amount: 197763.68,
                          billId: 18081,
                          materialId: 31367,
                        },
                      ],
                    },
                  ],
                },
              },
            },
            ordersAmount: {
              3243: {
                amount: 244237.71,
              },
              3247: {
                amount: 260287.1,
              },
              3254: {
                amount: 242570,
              },
              3266: {
                amount: 44657.32000000001,
              },
            },
            monthSigningAmountObj: {
              1302: 416037,
              1304: 173103,
            },
            monthOutSigningAmountObj: {
              1302: 0,
              1304: 242420,
            },
            departmentMonthTotalSigningAmountObj: {
              54: 416037,
              277: 173103,
            },
            rows: [
              {
                id: 332236,
                title: "1_54,2_1302,3_1038",
                type: 54,
                adminId: 1291,
                area: 0,
                peopleNum: null,
                houseSpace: null,
                houseType: 1,
                fitType: null,
                fitUse: 202502,
                houseState1: null,
                houseState2: null,
                houseState3: null,
                status: 1,
                data: {
                  fileId: 109,
                  id: 3243,
                  order_number: "HTCWC2502140916927",
                  orderStatus: 2,
                  customer: {
                    companyId: 1,
                    department: "北京城外城店",
                    departmentId: 2,
                    designDepartment: "北京城外城店",
                    designDepartmentId: 2,
                    designGroupName: "设计一组",
                    designGroupId: 54,
                    designLeaderName: "张洪庆",
                    designLeaderId: 1038,
                    designerName: "哪吒",
                    designerId: 1302,
                    saleDepartment: "",
                    saleDepartmentId: "",
                    saleGroupId: null,
                    salerId: null,
                    salerName: "无",
                    noSalePersonName: "无",
                    name: "套外-01",
                    mobile: "15713857011",
                    id: 75345,
                    customerChannel: "自拓",
                    customerSignType: "乐享家119800",
                    type: 847,
                    area: 120,
                    changeReason: null,
                    origin: {
                      department: "北京城外城店",
                      departmentId: 2,
                      designDepartment: "北京城外城店",
                      designDepartmentId: 2,
                      designGroupName: "设计一组",
                      designGroupId: 54,
                      designLeaderName: "张洪庆",
                      designerName: "哪吒",
                      designerId: 1302,
                      saleDepartment: "",
                      saleDepartmentId: "",
                      saleGroupName: "无",
                      saleGroupId: null,
                      salerId: null,
                      salerName: "无",
                    },
                  },
                  amount: {
                    designFee: 0,
                    designPriceAmount: 0,
                    signingAmount: 137780,
                    contractTotalAmount: 0,
                    contractTotalAmountRate: 0,
                    totalPrice: 137780,
                    specialOfferAmount: 0,
                    refundAmount: 0,
                    refundAmount401: 0,
                    refundAmount402: 0,
                    refundAmount403: 0,
                  },
                  refundIds: [],
                  refundCount: {
                    1: 0,
                    2: 0,
                  },
                  materials: [],
                },
                createdAt: "2025-02-14T01:45:16.000Z",
                updatedAt: "2025-02-14T03:02:19.000Z",
                targetId: 3243,
              },
              {
                id: 332275,
                title: "1_54,2_1302,3_1038",
                type: 54,
                adminId: 1291,
                area: 0,
                peopleNum: null,
                houseSpace: null,
                houseType: 1,
                fitType: null,
                fitUse: 202502,
                houseState1: null,
                houseState2: null,
                houseState3: null,
                status: 1,
                data: {
                  fileId: 109,
                  id: 3247,
                  order_number: "HTCWC2502141106139",
                  orderStatus: 2,
                  customer: {
                    companyId: 1,
                    department: "北京城外城店",
                    departmentId: 2,
                    designDepartment: "北京城外城店",
                    designDepartmentId: 2,
                    designGroupName: "设计一组",
                    designGroupId: 54,
                    designLeaderName: "张洪庆",
                    designLeaderId: 1038,
                    designerName: "哪吒",
                    designerId: 1302,
                    saleDepartment: "",
                    saleDepartmentId: "",
                    saleGroupId: null,
                    salerId: null,
                    salerName: "无",
                    noSalePersonName: "无",
                    name: "审0",
                    mobile: "15713857014",
                    id: 75349,
                    customerChannel: "自拓",
                    customerSignType: "乐享家119800",
                    type: 847,
                    area: 120,
                    changeReason: null,
                    origin: {
                      department: "北京城外城店",
                      departmentId: 2,
                      designDepartment: "北京城外城店",
                      designDepartmentId: 2,
                      designGroupName: "设计一组",
                      designGroupId: 54,
                      designLeaderName: "张洪庆",
                      designerName: "哪吒",
                      designerId: 1302,
                      saleDepartment: "",
                      saleDepartmentId: "",
                      saleGroupName: "无",
                      saleGroupId: null,
                      salerId: null,
                      salerName: "无",
                    },
                  },
                  amount: {
                    designFee: 0,
                    designPriceAmount: 0,
                    signingAmount: 137780,
                    contractTotalAmount: 0,
                    contractTotalAmountRate: 0,
                    totalPrice: 137780,
                    specialOfferAmount: 0,
                    refundAmount: 0,
                    refundAmount401: 0,
                    refundAmount402: 0,
                    refundAmount403: 0,
                  },
                  refundIds: [],
                  refundCount: {
                    1: 0,
                    2: 0,
                  },
                  materials: [],
                },
                createdAt: "2025-02-15T09:11:51.000Z",
                updatedAt: "2025-02-15T09:11:51.000Z",
                targetId: 3247,
              },
              {
                id: 332375,
                title: "1_54,2_1302,3_1038",
                type: 54,
                adminId: 1291,
                area: 0,
                peopleNum: null,
                houseSpace: null,
                houseType: 1,
                fitType: null,
                fitUse: 202502,
                houseState1: null,
                houseState2: null,
                houseState3: null,
                status: 1,
                data: {
                  fileId: 109,
                  id: 3254,
                  order_number: "HTCWC2502191537499",
                  orderStatus: 1,
                  customer: {
                    companyId: 1,
                    department: "北京城外城店",
                    departmentId: 2,
                    designDepartment: "北京城外城店",
                    designDepartmentId: 2,
                    designGroupName: "设计一组",
                    designGroupId: 54,
                    designLeaderName: "张洪庆",
                    designLeaderId: 1038,
                    designerName: "哪吒",
                    designerId: 1302,
                    saleDepartment: "",
                    saleDepartmentId: "",
                    saleGroupId: null,
                    salerId: null,
                    salerName: "无",
                    noSalePersonName: "无",
                    name: "套外-1",
                    mobile: "15713857021",
                    id: 75358,
                    customerChannel: "自拓",
                    customerSignType: "乐享家119800",
                    type: 847,
                    area: 123,
                    changeReason: null,
                    origin: {
                      department: "北京城外城店",
                      departmentId: 2,
                      designDepartment: "北京城外城店",
                      designDepartmentId: 2,
                      designGroupName: "设计一组",
                      designGroupId: 54,
                      designLeaderName: "张洪庆",
                      designerName: "哪吒",
                      designerId: 1302,
                      saleDepartment: "",
                      saleDepartmentId: "",
                      saleGroupName: "无",
                      saleGroupId: null,
                      salerId: null,
                      salerName: "无",
                    },
                    saleGroupName: "无",
                  },
                  amount: {
                    designFee: 0,
                    designPriceAmount: 0,
                    signingAmount: 140477,
                    contractTotalAmount: 0,
                    contractTotalAmountRate: 0,
                    totalPrice: 140477,
                    specialOfferAmount: 0,
                    refundAmount: 0,
                    refundAmount401: 0,
                    refundAmount402: 0,
                    refundAmount403: 0,
                    refundIds: [],
                    refundCount: {
                      1: 0,
                      2: 0,
                    },
                  },
                  refundIds: [],
                  refundCount: {
                    1: 0,
                    2: 0,
                  },
                  materials: [],
                },
                createdAt: "2025-02-19T07:47:23.000Z",
                updatedAt: "2025-03-05T09:00:58.000Z",
                targetId: 3254,
              },
              {
                id: 333954,
                title: "1_277,2_1304,3_1156",
                type: 54,
                adminId: 1291,
                area: 0,
                peopleNum: null,
                houseSpace: null,
                houseType: 1,
                fitType: null,
                fitUse: 202502,
                houseState1: null,
                houseState2: null,
                houseState3: null,
                status: 1,
                data: {
                  fileId: 122,
                  id: 3266,
                  order_number: "HTCWC2503031043122",
                  orderStatus: 1,
                  customer: {
                    companyId: 1,
                    department: "北京城外城店",
                    departmentId: 2,
                    designDepartment: "北京城外城店",
                    designDepartmentId: 2,
                    designGroupName: "设计五部",
                    designGroupId: 277,
                    designLeaderName: "刘元俊",
                    designerName: "400",
                    designerId: 1304,
                    saleDepartment: "",
                    saleDepartmentId: "",
                    saleGroupName: "无",
                    saleGroupId: null,
                    salerId: null,
                    salerName: "无",
                    noSalePersonName: "无",
                    name: "三月份",
                    mobile: "15713857030",
                    id: 75372,
                    customerChannel: "自拓",
                    customerSignType: "乐享家119800",
                    type: 847,
                    area: 150,
                  },
                  action_records: [
                    {
                      user_type: 1,
                      month: "2025-03",
                      confirm: true,
                      reason: "",
                      createdAt: "2025-04-23T09:10:24.270Z",
                    },
                    {
                      user_type: 2,
                      confirm: true,
                      reason: "",
                      createdAt: "2025-04-23T09:10:24.270Z",
                    },
                  ],
                  amount: {
                    designFee: 10000,
                    designPriceAmount: 10000,
                    designPriceAmountTime: "2025-03-03T02:47:16.000Z",
                    signingAmount: 173103,
                    contractTotalAmount: 100000,
                    contractTotalAmountRate: 0.5776,
                    specialOfferAmount: 1000,
                    totalPrice: 172103.31925,
                    refundAmount: 0,
                    refundAmount401: 0,
                    refundAmount402: 0,
                    refundAmount403: 0,
                  },
                  refundIds: [],
                  refundCount: {
                    1: 0,
                    2: 0,
                  },
                  materials: [
                    {
                      id: 31367,
                      groupId: 10653,
                      space: null,
                      materialId: 7054,
                      type: 1,
                      count: 10,
                      auditCount: 0,
                      discountScale: 100,
                      discountPrice: 0,
                      isAdvance: false,
                      advancePrice: 0,
                      isPref: false,
                      prefPrice: 0,
                      isUp: 0,
                      isRemove: false,
                      isReplace: false,
                      isOrder: 0,
                      isAudited: false,
                      isChange: false,
                      isKit: 0,
                      getPrice: 9933,
                      managerPrice: 4111,
                      scale: 0,
                      price: 24242,
                      removePrice: 30000,
                      paymentAmount: 242420,
                      refundAmount: 0,
                      stockDays: 30,
                      changeDays: 15,
                      adminId: 1304,
                      supplierId: 29,
                      distributionId: 29,
                      psBillId: 0,
                      relationId: null,
                      remarks: null,
                      single: null,
                      explain: "",
                      number: "WG3189168943",
                      name: "西门子冰箱-00102",
                      model: "DKAKF-AKD_123123",
                      spec: null,
                      brand: null,
                      unit: null,
                      conversionCoefficient: 0,
                      wastageRate: 0,
                      useConversionCoefficient: false,
                      auditStatus: 0,
                      countRecords: null,
                      createdAt: "2025-03-03T02:44:15.000Z",
                      updatedAt: "2025-04-23T09:09:03.000Z",
                      brandName: "西门子",
                      amount: "242420.00",
                      status: 2,
                    },
                  ],
                },
                createdAt: "2025-04-23T09:10:24.000Z",
                updatedAt: "2025-04-23T09:10:24.000Z",
                targetId: 3266,
              },
            ],
          },
          name: "2025年02月 套外业绩确认 - 设计",
          styles: {
            Header_Formatter: {},
            Percent_Formatter: {
              n: {
                pattern: "0.00%",
              },
            },
            Number_Formatter: {
              n: {
                pattern: "0.00",
              },
            },
          },
          id: "workbook-639",
          appVersion: "",
          sheetOrder: ["sheet_01"],
          sheets: {
            sheet_01: {
              name: "2025年02月 套外业绩确认 - 设计",
              id: "sheet_01",
              rowCount: 2,
              columnCount: 22,
              cellData: {
                0: {
                  0: {
                    v: "备注_0 ",
                    s: "Header_Formatter",
                  },
                  1: {
                    v: "ID_1 ",
                    s: "Header_Formatter",
                  },
                  2: {
                    v: "物料ID_2 ",
                    s: "Header_Formatter",
                  },
                  3: {
                    v: "序号_3 ",
                    s: "Header_Formatter",
                  },
                  4: {
                    v: "签约日期_4 ",
                    s: "Header_Formatter",
                  },
                  5: {
                    v: "所属店面_5 ",
                    s: "Header_Formatter",
                  },
                  6: {
                    v: "合同编号_6 ",
                    s: "Header_Formatter",
                  },
                  7: {
                    v: "客户来源_7 ",
                    s: "Header_Formatter",
                  },
                  8: {
                    v: "客户姓名_8 ",
                    s: "Header_Formatter",
                  },
                  9: {
                    v: "客户电话_9 ",
                    s: "Header_Formatter",
                  },
                  10: {
                    v: "面积_10 ",
                    s: "Header_Formatter",
                  },
                  11: {
                    v: "品类_11 ",
                    s: "Header_Formatter",
                  },
                  12: {
                    v: "物料名称_12 ",
                    s: "Header_Formatter",
                  },
                  13: {
                    v: "套外签单额_13 ",
                    s: "Header_Formatter",
                  },
                  14: {
                    v: "实收金额_14 ",
                    s: "Header_Formatter",
                  },
                  15: {
                    v: "实收比例_15 ",
                    s: "Header_Formatter",
                  },
                  16: {
                    v: "设计师_16 ",
                    s: "Header_Formatter",
                  },
                  17: {
                    v: "所属部门_17 ",
                    s: "Header_Formatter",
                  },
                  18: {
                    v: "套外占比_18 ",
                    s: "Header_Formatter",
                  },
                  19: {
                    v: "提点_19 ",
                    s: "Header_Formatter",
                  },
                  20: {
                    v: "提成发放比_20 ",
                    s: "Header_Formatter",
                  },
                  21: {
                    v: "设计师套外提成_21 ",
                    s: "Header_Formatter",
                  },
                },
                1: {
                  0: {
                    field: "designTichengAmount.bz",
                    v: "",
                  },
                  1: {
                    field: "id",
                    v: "333954",
                  },
                  2: {
                    field: "material.id",
                    v: "31367",
                  },
                  3: {
                    field: "index",
                    v: "1",
                  },
                  4: {
                    field: "signDate",
                    v: "2025年02月",
                  },
                  5: {
                    field: "customer.department",
                    v: "北京城外城店",
                  },
                  6: {
                    field: "order_number",
                    v: "HTCWC2503031043122",
                  },
                  7: {
                    field: "customer.customerChannel",
                    v: "自拓",
                  },
                  8: {
                    field: "customer.name",
                    v: "三月份",
                  },
                  9: {
                    field: "customer.mobile",
                    v: "15713857030",
                  },
                  10: {
                    field: "customer.area",
                    v: "150",
                    t: 2,
                    s: "Number_Formatter",
                  },
                  11: {
                    field: "material.brandName",
                    v: "西门子",
                  },
                  12: {
                    field: "material.name",
                    v: "西门子冰箱-00102",
                  },
                  13: {
                    field: "material.amount",
                    v: "242420.00",
                    t: 2,
                    s: "Number_Formatter",
                  },
                  14: {
                    field: "designTichengAmount.ss_je",
                    v: "242420",
                    t: 2,
                    s: "Number_Formatter",
                  },
                  15: {
                    field: "paymentRatio",
                    v: "0.58",
                    f: "=o2/n2",
                    t: 2,
                    s: "Percent_Formatter",
                  },
                  16: {
                    field: "customer.designerName",
                    v: "400",
                  },
                  17: {
                    field: "customer.designGroupName",
                    v: "设计五部",
                  },
                  18: {
                    field: "designTichengAmount.tw_zb",
                    v: "1.40",
                    t: 2,
                    s: "Percent_Formatter",
                  },
                  19: {
                    field: "designTichengAmount.td",
                    v: "20",
                    t: 2,
                    s: "Number_Formatter",
                  },
                  20: {
                    field: "designTichengAmount.ffb",
                    v: "1.00",
                    t: 2,
                    s: "Percent_Formatter",
                  },
                  21: {
                    field: "designTichengAmount.tc",
                    v: "20",
                    f: "=t2*u2",
                    t: 2,
                    s: "Number_Formatter",
                  },
                },
              },
              columnData: {
                0: {
                  w: 121,
                },
                1: {
                  w: 78,
                },
                2: {
                  w: 78,
                },
                3: {
                  w: 57,
                },
                4: {
                  w: 108,
                },
                5: {
                  w: 173,
                },
                6: {
                  w: 187,
                },
                7: {
                  w: 112,
                },
                8: {
                  w: 98,
                },
                9: {
                  w: 98,
                },
                10: {
                  w: 75,
                },
                11: {
                  w: 147,
                },
                12: {
                  w: 147,
                },
                13: {
                  w: 96,
                },
                14: {
                  w: 96,
                },
                15: {
                  w: 96,
                },
                16: {
                  w: 128,
                },
                17: {
                  w: 143,
                },
                18: {
                  w: 143,
                },
                19: {
                  w: 169,
                },
                20: {
                  w: 112,
                },
                21: {
                  w: 207,
                },
              },
              freeze: {
                startColumn: -1,
                startRow: 1,
                xSplit: 0,
                ySplit: 1,
              },
            },
          },
          resources: [
            {
              name: "SHEET_RANGE_PROTECTION_PLUGIN",
              data: '{"sheet_01":[{"unitId":"workbook-639","subUnitId":"sheet_01","unitType":3,"ranges":[{"startRow":0,"startColumn":0,"endRow":0,"endColumn":21,"rangeType":1,"sheetId":"sheet_01","startAbsoluteRefType":0,"endAbsoluteRefType":0}]},{"unitId":"workbook-639","subUnitId":"sheet_01","unitType":3,"ranges":[{"startRow":1,"startColumn":1,"endRow":1,"endColumn":18,"rangeType":0,"sheetId":"sheet_01","startAbsoluteRefType":0,"endAbsoluteRefType":0}]}]}',
            },
          ],
          payload: {
            authRanges: [
              {
                startRow: 0,
                startColumn: 0,
                endRow: 0,
                endColumn: 21,
                rangeType: 1,
                sheetId: "sheet_01",
              },
              {
                startRow: 1,
                startColumn: 1,
                endRow: 1,
                endColumn: 18,
                rangeType: 0,
                sheetId: "sheet_01",
              },
            ],
          },
        },
        message: "请求成功",
        testVersion: "v1.0.6",
        time: "34ms",
        env: "test",
      };
      const { testData } = json.data;
      console.log("testData", testData);
      const { rows, source } = testData;
      mergeRefundsToRecords({ records: rows, bills: source });
      function mergeRefundsToRecords({ records, bills }) {
        const billsMap = {};
        bills.forEach(bill => {
          if (billsMap[bill.targetId]) {
            billsMap[bill.targetId].push(bill);
          } else {
            billsMap[bill.targetId] = [bill];
          }
        });
        records.forEach(record => {
          const billMap = billsMap[record.targetId];
          billMap?.forEach(bill => {
            // 物料退款单
            bill.refundMaterials?.forEach(refund => {
              record.data?.materials?.forEach(material => {
                if (material.id === refund.materialId) {
                  material.refundAmount += refund.amount;
                }
              });
            });
          });
        });
      }
      console.log("rows", rows);
    </script>
  </body>
</html>

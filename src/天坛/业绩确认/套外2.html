<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      const rows = [
        {
          id: 333934,
          title: "1_54,2_1302,3_1038",
          type: 54,
          adminId: 1291,
          area: 0,
          peopleNum: null,
          houseSpace: null,
          houseType: 1,
          fitType: null,
          fitUse: 202501,
          houseState1: null,
          houseState2: null,
          houseState3: null,
          status: 1,
          data: {
            fileId: 122,
            id: 3260,
            order_number: "HTCWC2502280919859",
            orderStatus: 1,
            customer: {
              companyId: 1,
              department: "北京城外城店",
              departmentId: 2,
              designDepartment: "北京城外城店",
              designDepartmentId: 2,
              designGroupName: "设计一组",
              designGroupId: 54,
              designLeaderName: "张洪庆",
              designerName: "哪吒",
              designerId: 1302,
              saleDepartment: "",
              saleDepartmentId: "",
              saleGroupName: "无",
              saleGroupId: null,
              salerId: null,
              salerName: "无",
              noSalePersonName: "无",
              name: "003",
              mobile: "15713857025",
              id: 75366,
              customerChannel: "自拓",
              customerSignType: "乐享家119800",
              type: 847,
              area: 140,
            },
            action_records: [
              {
                user_type: 1,
                month: "2025-03",
                confirm: true,
                reason: "",
                createdAt: "2025-04-23T05:59:24.259Z",
              },
              {
                user_type: 2,
                confirm: true,
                reason: "",
                createdAt: "2025-04-23T05:59:24.259Z",
              },
            ],
            amount: {
              designFee: 8000,
              designPriceAmount: 8000,
              designPriceAmountTime: "2025-02-28T01:47:20.000Z",
              signingAmount: 409042,
              contractTotalAmount: 6000,
              contractTotalAmountRate: 0.0146,
              specialOfferAmount: 10000,
              totalPrice: 399042.819,
              refundAmount: 0,
              refundAmount401: 0,
              refundAmount402: 0,
              refundAmount403: 0,
            },
            refundIds: [],
            refundCount: {
              1: 0,
              2: 0,
            },
            materials: [
              {
                id: 31336,
                groupId: 10644,
                space: null,
                materialId: 6486,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 0.35,
                managerPrice: 0,
                scale: 0,
                price: 1,
                removePrice: 750,
                paymentAmount: 10,
                refundAmount: 0,
                stockDays: 0,
                changeDays: 0,
                adminId: 1302,
                supplierId: 2,
                distributionId: 2,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: null,
                number: "WG8371729093",
                name: "测试一块采购",
                model: "JSF-Fas19293",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-02-28T01:20:56.000Z",
                updatedAt: "2025-03-31T09:33:21.000Z",
                brandName: "西门子",
                amount: "10.00",
                status: 2,
              },
              {
                id: 31337,
                groupId: 10644,
                space: null,
                materialId: 7054,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 9933,
                managerPrice: 4111,
                scale: 0,
                price: 24242,
                removePrice: 30000,
                paymentAmount: 242420,
                refundAmount: 0,
                stockDays: 30,
                changeDays: 15,
                adminId: 1302,
                supplierId: 29,
                distributionId: 29,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "",
                number: "WG3189168943",
                name: "西门子冰箱-00102",
                model: "DKAKF-AKD_123123",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-02-28T01:20:56.000Z",
                updatedAt: "2025-03-31T09:33:21.000Z",
                brandName: "西门子",
                amount: "242420.00",
                status: 2,
              },
            ],
          },
          createdAt: "2025-04-23T05:59:24.000Z",
          updatedAt: "2025-04-23T05:59:24.000Z",
          targetId: 3260,
        },
        {
          id: 333930,
          title: "1_54,2_1302,3_1038",
          type: 54,
          adminId: 1291,
          area: 0,
          peopleNum: null,
          houseSpace: null,
          houseType: 1,
          fitType: null,
          fitUse: 202501,
          houseState1: null,
          houseState2: null,
          houseState3: null,
          status: 1,
          data: {
            fileId: 122,
            id: 3267,
            order_number: "HTCWC2503041147549",
            orderStatus: 1,
            customer: {
              companyId: 1,
              department: "北京城外城店",
              departmentId: 2,
              designDepartment: "北京城外城店",
              designDepartmentId: 2,
              designGroupName: "设计一组",
              designGroupId: 54,
              designLeaderName: "张洪庆",
              designerName: "哪吒",
              designerId: 1302,
              saleDepartment: "",
              saleDepartmentId: "",
              saleGroupName: "无",
              saleGroupId: null,
              salerId: null,
              salerName: "无",
              noSalePersonName: "无",
              name: "004",
              mobile: "15713857031",
              id: 75373,
              customerChannel: "自拓",
              customerSignType: "乐享家119800",
              type: 847,
              area: 150,
            },
            action_records: [
              {
                user_type: 1,
                month: "2025-03",
                confirm: true,
                reason: "",
                createdAt: "2025-04-23T03:51:18.312Z",
              },
              {
                user_type: 2,
                confirm: true,
                reason: "",
                createdAt: "2025-04-23T03:51:18.312Z",
              },
            ],
            amount: {
              designFee: 20000,
              designPriceAmount: 0,
              designPriceAmountTime: null,
              signingAmount: 233453,
              contractTotalAmount: -50000,
              contractTotalAmountRate: -0.2141,
              specialOfferAmount: 1000,
              totalPrice: 232453.21556799999,
              refundAmount: 110000,
              refundAmount401: 50000,
              refundAmount402: 60000,
              refundAmount403: 0,
            },
            refundIds: [17035, 17036],
            refundCount: {
              1: 0,
              2: 0,
            },
            materials: [
              {
                id: 31409,
                groupId: 10659,
                space: null,
                materialId: 6486,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 0.35,
                managerPrice: 0,
                scale: 0,
                price: 1,
                removePrice: 750,
                paymentAmount: 10,
                refundAmount: 0,
                stockDays: 0,
                changeDays: 0,
                adminId: 1302,
                supplierId: 2,
                distributionId: 2,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: null,
                number: "WG8371729093",
                name: "测试一块采购",
                model: "JSF-Fas19293",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-03-04T03:56:45.000Z",
                updatedAt: "2025-03-06T07:55:50.000Z",
                brandName: "西门子",
                amount: "10.00",
                status: 2,
              },
              {
                id: 31410,
                groupId: 10659,
                space: null,
                materialId: 7054,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 9933,
                managerPrice: 4111,
                scale: 0,
                price: 24242,
                removePrice: 30000,
                paymentAmount: 242420,
                refundAmount: 0,
                stockDays: 30,
                changeDays: 15,
                adminId: 1302,
                supplierId: 29,
                distributionId: 29,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "",
                number: "WG3189168943",
                name: "西门子冰箱-00102",
                model: "DKAKF-AKD_123123",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-03-04T03:56:45.000Z",
                updatedAt: "2025-03-06T07:55:49.000Z",
                brandName: "西门子",
                amount: "242420.00",
                status: 2,
              },
              {
                id: 31411,
                groupId: 10659,
                space: null,
                materialId: 7027,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 1150,
                managerPrice: 1625,
                scale: 0,
                price: 1785.71,
                removePrice: 937.5,
                paymentAmount: 17857.1,
                refundAmount: 0,
                stockDays: 0,
                changeDays: 0,
                adminId: 1302,
                supplierId: 29,
                distributionId: 29,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "",
                number: "WG9641791453",
                name: "YN-100206",
                model: "ML-130",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-03-04T03:56:45.000Z",
                updatedAt: "2025-03-06T07:55:50.000Z",
                brandName: "西门子",
                amount: "17857.10",
                status: 2,
              },
              {
                id: 31412,
                groupId: 10659,
                space: null,
                materialId: 6484,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 12,
                managerPrice: 0,
                scale: 0,
                price: 16,
                removePrice: 0,
                paymentAmount: 160,
                refundAmount: 0,
                stockDays: 0,
                changeDays: 0,
                adminId: 1302,
                supplierId: 2,
                distributionId: 2,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "测",
                number: "WG7098987259",
                name: "测试灯具灯具灯具灯具灯具",
                model: "测试型号AA",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-03-04T03:56:45.000Z",
                updatedAt: "2025-03-06T07:55:50.000Z",
                brandName: "西门子",
                amount: "160.00",
                status: 2,
              },
              {
                id: 31413,
                groupId: 10659,
                space: null,
                materialId: 7028,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 1,
                managerPrice: 2,
                scale: 0,
                price: 1,
                removePrice: 2,
                paymentAmount: 10,
                refundAmount: 0,
                stockDays: 3,
                changeDays: 3,
                adminId: 1302,
                supplierId: 89,
                distributionId: 13,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "",
                number: "WG1719621358",
                name: "测试——西卡",
                model: "",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-03-04T03:56:45.000Z",
                updatedAt: "2025-03-06T07:55:49.000Z",
                brandName: "西卡",
                amount: "10.00",
                status: 2,
              },
              {
                id: 31414,
                groupId: 10659,
                space: null,
                materialId: 6483,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 11,
                managerPrice: 0,
                scale: 0,
                price: 14,
                removePrice: 0,
                paymentAmount: 140,
                refundAmount: 0,
                stockDays: 0,
                changeDays: 0,
                adminId: 1302,
                supplierId: 2,
                distributionId: 2,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "测",
                number: "WG5210399287",
                name: "测试套外新建主材",
                model: "测试型号AA",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-03-04T03:56:45.000Z",
                updatedAt: "2025-03-06T07:55:50.000Z",
                brandName: "西门子",
                amount: "140.00",
                status: 2,
              },
            ],
          },
          createdAt: "2025-04-23T03:51:18.000Z",
          updatedAt: "2025-04-23T03:51:18.000Z",
          targetId: 3267,
        },
        {
          id: 333937,
          title: "1_277,2_1304,3_1156",
          type: 54,
          adminId: 1291,
          area: 0,
          peopleNum: null,
          houseSpace: null,
          houseType: 1,
          fitType: null,
          fitUse: 202501,
          houseState1: null,
          houseState2: null,
          houseState3: null,
          status: 1,
          data: {
            fileId: 122,
            id: 3290,
            order_number: "HTCWC2504160938960",
            orderStatus: 1,
            customer: {
              companyId: 1,
              department: "北京城外城店",
              departmentId: 2,
              designDepartment: "北京城外城店",
              designDepartmentId: 2,
              designGroupName: "设计五部",
              designGroupId: 277,
              designLeaderName: "刘元俊",
              designerName: "400",
              designerId: 1304,
              saleDepartment: "",
              saleDepartmentId: "",
              saleGroupName: "无",
              saleGroupId: null,
              salerId: null,
              salerName: "无",
              noSalePersonName: "无",
              name: "0937",
              mobile: "15713857100",
              id: 75401,
              customerChannel: "自拓",
              customerSignType: "乐享家119800",
              type: 847,
              area: 150,
            },
            action_records: [
              {
                user_type: 1,
                month: "2025-03",
                confirm: true,
                reason: "",
                createdAt: "2025-04-23T06:06:47.831Z",
              },
              {
                user_type: 2,
                confirm: true,
                reason: "",
                createdAt: "2025-04-23T06:06:47.831Z",
              },
            ],
            amount: {
              designFee: 10000,
              designPriceAmount: 10000,
              designPriceAmountTime: "2025-04-16T01:50:38.000Z",
              signingAmount: 423353,
              contractTotalAmount: 200000,
              contractTotalAmountRate: 0.4724,
              specialOfferAmount: 1000,
              totalPrice: 422353.96128,
              refundAmount: 0,
              refundAmount401: 0,
              refundAmount402: 0,
              refundAmount403: 0,
            },
            refundIds: [],
            refundCount: {
              1: 0,
              2: 0,
            },
            materials: [
              {
                id: 31889,
                groupId: 10803,
                space: null,
                materialId: 7072,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 3680,
                managerPrice: 5000,
                scale: 0,
                price: 6800,
                removePrice: 6000,
                paymentAmount: 68000,
                refundAmount: 0,
                stockDays: 0,
                changeDays: 0,
                adminId: 1304,
                supplierId: 103,
                distributionId: 103,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "",
                number: "WG0066325130",
                name: "乐彤冰箱",
                model: "",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-04-16T01:40:32.000Z",
                updatedAt: "2025-04-16T01:51:25.000Z",
                brandName: "西门子",
                amount: "68000.00",
                status: 2,
              },
              {
                id: 31890,
                groupId: 10803,
                space: null,
                materialId: 6484,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 12,
                managerPrice: 0,
                scale: 0,
                price: 16,
                removePrice: 0,
                paymentAmount: 160,
                refundAmount: 0,
                stockDays: 0,
                changeDays: 0,
                adminId: 1304,
                supplierId: 2,
                distributionId: 2,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "测",
                number: "WG7098987259",
                name: "测试灯具灯具灯具灯具灯具",
                model: "测试型号AA",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-04-16T01:40:32.000Z",
                updatedAt: "2025-04-16T01:51:25.000Z",
                brandName: "西门子",
                amount: "160.00",
                status: 2,
              },
              {
                id: 31891,
                groupId: 10803,
                space: null,
                materialId: 6486,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 0.35,
                managerPrice: 0,
                scale: 0,
                price: 1,
                removePrice: 750,
                paymentAmount: 10,
                refundAmount: 0,
                stockDays: 0,
                changeDays: 0,
                adminId: 1304,
                supplierId: 2,
                distributionId: 2,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: null,
                number: "WG8371729093",
                name: "测试一块采购",
                model: "JSF-Fas19293",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-04-16T01:40:32.000Z",
                updatedAt: "2025-04-16T01:51:25.000Z",
                brandName: "西门子",
                amount: "10.00",
                status: 2,
              },
              {
                id: 31892,
                groupId: 10803,
                space: null,
                materialId: 7054,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 9933,
                managerPrice: 4111,
                scale: 0,
                price: 24242,
                removePrice: 30000,
                paymentAmount: 242420,
                refundAmount: 0,
                stockDays: 30,
                changeDays: 15,
                adminId: 1304,
                supplierId: 29,
                distributionId: 29,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "",
                number: "WG3189168943",
                name: "西门子冰箱-00102",
                model: "DKAKF-AKD_123123",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-04-16T01:40:32.000Z",
                updatedAt: "2025-04-16T01:51:25.000Z",
                brandName: "西门子",
                amount: "242420.00",
                status: 2,
              },
              {
                id: 31893,
                groupId: 10803,
                space: null,
                materialId: 7027,
                type: 1,
                count: 10,
                auditCount: 0,
                discountScale: 100,
                discountPrice: 0,
                isAdvance: false,
                advancePrice: 0,
                isPref: false,
                prefPrice: 0,
                isUp: 0,
                isRemove: false,
                isReplace: false,
                isOrder: 0,
                isAudited: false,
                isChange: false,
                isKit: 0,
                getPrice: 1150,
                managerPrice: 1625,
                scale: 0,
                price: 1785.71,
                removePrice: 937.5,
                paymentAmount: 17857.1,
                refundAmount: 0,
                stockDays: 0,
                changeDays: 0,
                adminId: 1304,
                supplierId: 29,
                distributionId: 29,
                psBillId: 0,
                relationId: null,
                remarks: null,
                single: null,
                explain: "",
                number: "WG9641791453",
                name: "YN-100206",
                model: "ML-130",
                spec: null,
                brand: null,
                unit: null,
                conversionCoefficient: 0,
                wastageRate: 0,
                useConversionCoefficient: false,
                auditStatus: 0,
                countRecords: null,
                createdAt: "2025-04-16T01:40:32.000Z",
                updatedAt: "2025-04-16T01:51:25.000Z",
                brandName: "西门子",
                amount: "17857.10",
                status: 2,
              },
            ],
          },
          createdAt: "2025-04-23T06:06:47.000Z",
          updatedAt: "2025-04-23T06:06:47.000Z",
          targetId: 3290,
        },
      ];
      /**
       * 计算每个设计师ID的金额累计（排除customerSignType包含"+499"的订单）
       * @param {Array} records 数据源
       * @param {string} path 属性路径，如"amount.signingAmount"或"materials"
       * @returns {Object} 返回格式为 {设计师id: 金额累计}
       */
      function sumAmountByDesigner(records, path) {
        const result = {};

        for (const record of records) {
          // 获取设计师ID和客户信息
          const designerId = record.data?.customer?.designerId;
          const customerSignType = record.data?.customer?.customerSignType || "";

          // 跳过无效的设计师ID或包含"+499"的订单
          if (!designerId || customerSignType.includes("+499")) {
            continue;
          }

          // 直接使用data对象（假设已经是对象）
          const data = record.data;

          // 根据路径获取值
          const value = getValueByPath(data, path);

          // 累加到结果中
          if (value !== undefined && value !== null) {
            result[designerId] = (result[designerId] || 0) + value;
          }
        }

        return result;
      }

      /**
       * 根据路径获取值，并处理特殊情况（如materials数组）
       * @param {Object} obj 数据对象
       * @param {string} path 属性路径
       * @returns {number} 计算后的值
       */
      function getValueByPath(obj, path) {
        const parts = path.split(".");
        let current = obj;

        // 沿着路径获取值
        for (const part of parts) {
          if (current[part] === undefined) return 0;
          current = current[part];
        }

        // 处理materials数组的情况
        if (Array.isArray(current)) {
          return current.reduce((sum, material) => {
            const payment = Number(material.paymentAmount) || 0;
            const refund = Number(material.refundAmount) || 0;
            return sum + (payment - refund);
          }, 0);
        }

        // 处理普通数值（确保转换为数字）
        return Number(current) || 0;
      }
      // 使用示例（注意路径不需要加"data."前缀）
      const signingAmountSum = sumAmountByDesigner(rows, "amount.signingAmount");
      console.log("签约金额总和:", signingAmountSum);

      const materialsSum = sumAmountByDesigner(rows, "materials");
      console.log("材料净额总和:", materialsSum);
    </script>
  </body>
</html>

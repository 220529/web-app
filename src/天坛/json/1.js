const json1 =
  '{"funText":"/**\\n * @formatId 454\\n * @formatKey atgftoc3p3acms5d\\n * @formatName 人力保存录入的部门业绩数据\\n * @updateTime 2025-02-28 13:59:10\\n */\\nconst runRes = await UniverSheetIframeRef.runSheetMethod({\\n  funText: `const activeWorkbook = univerAPI.getActiveWorkbook();return activeWorkbook.save()`,\\n});\\nconst sheetData =\\n  Object.values(runRes?.sheets.sheet_01.cellData).slice(1) || [];\\nreturn {\\n  runRes,\\n  sheetData,\\n};\\nreturn {\\n  flowId: params.flowId,\\n  params: {\\n    sheetData,\\n    departmentId: params.departmentId,\\n    groupType: params.groupType,\\n    fitUse: params.fitUse,\\n    houseType: params.performanceType,\\n  },\\n};","params":{},"updateTime":"2025-02-28 13:59:10"}';

console.log("json1", JSON.parse(json1));

function toFixed(val, num = 2) {
  return +(+(val || 0)).toFixed(num);
}

console.log(toFixed(6000), toFixed("6000"));

const json2 = {
  flowId: 453,
  sheetData: [
    {
      0: { field: "designRemark", sourceValue: "", v: "" },
      1: { field: "id", sourceValue: 332472, v: "332472" },
      2: { field: "index", sourceValue: 1, v: "1" },
      3: { field: "signDate", sourceValue: "2025年02月", v: "2025年02月" },
      4: { field: "order_number", sourceValue: "HTCWC2502280957555", v: "HTCWC2502280957555" },
      5: { field: "customer.customerChannel", sourceValue: "自拓", v: "自拓" },
      6: { field: "customer.name", sourceValue: "005", v: "005" },
      7: { field: "customer.area", sourceValue: 150, v: "150", t: 2, s: "Number_Formatter" },
      8: { field: "customer.customerSignType", sourceValue: "乐享家119800", v: "乐享家119800" },
      9: { field: "customer.saleGroupName", sourceValue: "无", v: "无" },
      10: { field: "customer.saleLeaderName", sourceValue: "", v: "" },
      11: { field: "customer.salerName", sourceValue: "无", v: "无" },
      12: {
        field: "amount.signingAmount",
        sourceValue: 164750,
        v: "164750",
        t: 2,
        s: "Number_Formatter",
      },
      13: {
        field: "realPaymentAmount",
        sourceValue: 120000,
        v: "120000",
        t: 2,
        s: "Number_Formatter",
      },
      14: { field: "paymentRatio", sourceValue: "72.84", v: "0.73", t: 2, s: "Percent_Formatter" },
      15: {
        field: "discountAmount",
        sourceValue: 164750,
        v: "164750",
        t: 2,
        s: "Number_Formatter",
      },
      16: { field: "amount.remoteFee", sourceValue: "", v: "", t: 2, s: "Number_Formatter" },
      17: {
        field: "amount.designFee",
        sourceValue: 100000,
        v: "100000",
        t: 2,
        s: "Number_Formatter",
      },
      18: { field: "isStart", sourceValue: "否", v: "否" },
      19: { field: "customer.department", sourceValue: "北京城外城店", v: "北京城外城店" },
      20: { field: "customer.designGroupName", sourceValue: "设计一组", v: "设计一组" },
      21: { field: "customer.designerName", sourceValue: "哪吒", v: "哪吒" },
      22: { field: "designTichengAmount.isProbationPeriod", sourceValue: "", v: "" },
      23: {
        field: "designTichengAmount.sjf_td",
        sourceValue: 60,
        v: "0.60",
        t: 2,
        s: "Percent_Formatter",
      },
      24: {
        field: "designTichengAmount.sjf_tc",
        sourceValue: 60000,
        v: 60000,
        f: "=(R2*X2)",
        t: 2,
        s: "Number_Formatter",
      },
      25: {
        field: "designTichengAmount.sjf_tc_rate",
        sourceValue: 0,
        v: "0.00",
        t: 2,
        s: "Percent_Formatter",
      },
      26: {
        field: "designTichengAmount.sjf_tc_hf",
        sourceValue: 45000,
        v: "45000",
        t: 2,
        s: "Number_Formatter",
      },
      27: {
        field: "designTichengAmount.sjf_tc_sf",
        sourceValue: 15000,
        v: 0,
        f: "=(Y2*Z2)",
        t: 2,
        s: "Number_Formatter",
      },
      28: { field: "customer.designLeaderName", sourceValue: "张洪庆", v: "张洪庆" },
      29: {
        field: "designLeaderTichengAmount.sjf_td",
        sourceValue: 5,
        v: "0.05",
        t: 2,
        s: "Percent_Formatter",
      },
      30: {
        field: "designLeaderTichengAmount.sjf_tc",
        sourceValue: 6000,
        v: 5000,
        f: "=(R2*AD2)",
        t: 2,
        s: "Number_Formatter",
      },
    },
    {
      0: { field: "designRemark", sourceValue: "", v: "" },
      1: { field: "id", sourceValue: 332410, v: "332410" },
      2: { field: "index", sourceValue: 2, v: "2" },
      3: { field: "signDate", sourceValue: "2025年02月", v: "2025年02月" },
      4: { field: "order_number", sourceValue: "HTCWC2502211359747", v: "HTCWC2502211359747" },
      5: { field: "customer.customerChannel", sourceValue: "自拓", v: "自拓" },
      6: { field: "customer.name", sourceValue: "设计费0", v: "设计费0" },
      7: { field: "customer.area", sourceValue: 121, v: "121", t: 2, s: "Number_Formatter" },
      8: { field: "customer.customerSignType", sourceValue: "乐享家119800", v: "乐享家119800" },
      9: { field: "customer.saleGroupName", sourceValue: "无", v: "无" },
      10: { field: "customer.saleLeaderName", sourceValue: "", v: "" },
      11: { field: "customer.salerName", sourceValue: "无", v: "无" },
      12: {
        field: "amount.signingAmount",
        sourceValue: 138679,
        v: "138679",
        t: 2,
        s: "Number_Formatter",
      },
      13: {
        field: "realPaymentAmount",
        sourceValue: 100000000000,
        v: "100000000000",
        t: 2,
        s: "Number_Formatter",
      },
      14: {
        field: "paymentRatio",
        sourceValue: "72108971.08",
        v: "721089.71",
        t: 2,
        s: "Percent_Formatter",
      },
      15: {
        field: "discountAmount",
        sourceValue: 138679,
        v: "138679",
        t: 2,
        s: "Number_Formatter",
      },
      16: { field: "amount.remoteFee", sourceValue: "", v: "", t: 2, s: "Number_Formatter" },
      17: {
        field: "amount.designFee",
        sourceValue: 20000,
        v: "20000",
        t: 2,
        s: "Number_Formatter",
      },
      18: { field: "isStart", sourceValue: "是", v: "是" },
      19: { field: "customer.department", sourceValue: "北京城外城店", v: "北京城外城店" },
      20: { field: "customer.designGroupName", sourceValue: "设计一组", v: "设计一组" },
      21: { field: "customer.designerName", sourceValue: "哪吒", v: "哪吒" },
      22: { field: "designTichengAmount.isProbationPeriod", sourceValue: "", v: "" },
      23: {
        field: "designTichengAmount.sjf_td",
        sourceValue: 60,
        v: "0.60",
        t: 2,
        s: "Percent_Formatter",
      },
      24: {
        field: "designTichengAmount.sjf_tc",
        sourceValue: 12000,
        v: 12000,
        f: "=(R3*X3)",
        t: 2,
        s: "Number_Formatter",
      },
      25: {
        field: "designTichengAmount.sjf_tc_rate",
        sourceValue: 75,
        v: "0.75",
        t: 2,
        s: "Percent_Formatter",
      },
      26: {
        field: "designTichengAmount.sjf_tc_hf",
        sourceValue: 0,
        v: "0",
        t: 2,
        s: "Number_Formatter",
      },
      27: {
        field: "designTichengAmount.sjf_tc_sf",
        sourceValue: 12000,
        v: 9000,
        f: "=(Y3*Z3)",
        t: 2,
        s: "Number_Formatter",
      },
      28: { field: "customer.designLeaderName", sourceValue: "张洪庆", v: "张洪庆" },
      29: {
        field: "designLeaderTichengAmount.sjf_td",
        sourceValue: 5,
        v: "0.05",
        t: 2,
        s: "Percent_Formatter",
      },
      30: {
        field: "designLeaderTichengAmount.sjf_tc",
        sourceValue: 6000,
        v: 1000,
        f: "=(R3*AD3)",
        t: 2,
        s: "Number_Formatter",
      },
    },
    {
      0: { field: "designRemark", sourceValue: "", v: "" },
      1: { field: "id", sourceValue: 332476, v: "332476" },
      2: { field: "index", sourceValue: 3, v: "3" },
      3: { field: "signDate", sourceValue: "2025年02月", v: "2025年02月" },
      4: { field: "order_number", sourceValue: "HTCWC2502281048413", v: "HTCWC2502281048413" },
      5: { field: "customer.customerChannel", sourceValue: "自拓", v: "自拓" },
      6: { field: "customer.name", sourceValue: "人力-设计费", v: "人力-设计费" },
      7: { field: "customer.area", sourceValue: 120, v: "120", t: 2, s: "Number_Formatter" },
      8: { field: "customer.customerSignType", sourceValue: "乐享家119800", v: "乐享家119800" },
      9: { field: "customer.saleGroupName", sourceValue: "无", v: "无" },
      10: { field: "customer.saleLeaderName", sourceValue: "", v: "" },
      11: { field: "customer.salerName", sourceValue: "无", v: "无" },
      12: {
        field: "amount.signingAmount",
        sourceValue: 139157,
        v: "139157",
        t: 2,
        s: "Number_Formatter",
      },
      13: {
        field: "realPaymentAmount",
        sourceValue: 100000,
        v: "100000",
        t: 2,
        s: "Number_Formatter",
      },
      14: { field: "paymentRatio", sourceValue: "71.86", v: "0.72", t: 2, s: "Percent_Formatter" },
      15: {
        field: "discountAmount",
        sourceValue: 139157,
        v: "139157",
        t: 2,
        s: "Number_Formatter",
      },
      16: { field: "amount.remoteFee", sourceValue: "", v: "", t: 2, s: "Number_Formatter" },
      17: {
        field: "amount.designFee",
        sourceValue: 10000,
        v: "10000",
        t: 2,
        s: "Number_Formatter",
      },
      18: { field: "isStart", sourceValue: "否", v: "否" },
      19: { field: "customer.department", sourceValue: "北京城外城店", v: "北京城外城店" },
      20: { field: "customer.designGroupName", sourceValue: "设计五部", v: "设计五部" },
      21: { field: "customer.designerName", sourceValue: "400", v: "400" },
      22: { field: "designTichengAmount.isProbationPeriod", sourceValue: "", v: "" },
      23: {
        field: "designTichengAmount.sjf_td",
        sourceValue: 60,
        v: "0.60",
        t: 2,
        s: "Percent_Formatter",
      },
      24: {
        field: "designTichengAmount.sjf_tc",
        sourceValue: 6000,
        v: 6000,
        f: "=(R4*X4)",
        t: 2,
        s: "Number_Formatter",
      },
      25: {
        field: "designTichengAmount.sjf_tc_rate",
        sourceValue: 0,
        v: "0.00",
        t: 2,
        s: "Percent_Formatter",
      },
      26: {
        field: "designTichengAmount.sjf_tc_hf",
        sourceValue: 4500,
        v: "4500",
        t: 2,
        s: "Number_Formatter",
      },
      27: {
        field: "designTichengAmount.sjf_tc_sf",
        sourceValue: 1500,
        v: 0,
        f: "=(Y4*Z4)",
        t: 2,
        s: "Number_Formatter",
      },
      28: { field: "customer.designLeaderName", sourceValue: "刘元俊", v: "刘元俊" },
      29: {
        field: "designLeaderTichengAmount.sjf_td",
        sourceValue: 3,
        v: "0.03",
        t: 2,
        s: "Percent_Formatter",
      },
      30: {
        field: "designLeaderTichengAmount.sjf_tc",
        sourceValue: 600,
        v: 300,
        f: "=(R4*AD4)",
        t: 2,
        s: "Number_Formatter",
      },
    },
    {
      0: { field: "designRemark", sourceValue: "", v: "" },
      1: { field: "id", sourceValue: 332503, v: "332503" },
      2: { field: "index", sourceValue: 4, v: "4" },
      3: { field: "signDate", sourceValue: "2025年02月", v: "2025年02月" },
      4: { field: "order_number", sourceValue: "HTCWC2503031043122", v: "HTCWC2503031043122" },
      5: { field: "customer.customerChannel", sourceValue: "自拓", v: "自拓" },
      6: { field: "customer.name", sourceValue: "三月份", v: "三月份" },
      7: { field: "customer.area", sourceValue: 150, v: "150", t: 2, s: "Number_Formatter" },
      8: { field: "customer.customerSignType", sourceValue: "乐享家119800", v: "乐享家119800" },
      9: { field: "customer.saleGroupName", sourceValue: "无", v: "无" },
      10: { field: "customer.saleLeaderName", sourceValue: "", v: "" },
      11: { field: "customer.salerName", sourceValue: "无", v: "无" },
      12: {
        field: "amount.signingAmount",
        sourceValue: 173103,
        v: "173103",
        t: 2,
        s: "Number_Formatter",
      },
      13: {
        field: "realPaymentAmount",
        sourceValue: 100000,
        v: "100000",
        t: 2,
        s: "Number_Formatter",
      },
      14: { field: "paymentRatio", sourceValue: "57.77", v: "0.58", t: 2, s: "Percent_Formatter" },
      15: {
        field: "discountAmount",
        sourceValue: 173103,
        v: "173103",
        t: 2,
        s: "Number_Formatter",
      },
      16: { field: "amount.remoteFee", sourceValue: "", v: "", t: 2, s: "Number_Formatter" },
      17: {
        field: "amount.designFee",
        sourceValue: 10000,
        v: "10000",
        t: 2,
        s: "Number_Formatter",
      },
      18: { field: "isStart", sourceValue: "否", v: "否" },
      19: { field: "customer.department", sourceValue: "北京城外城店", v: "北京城外城店" },
      20: { field: "customer.designGroupName", sourceValue: "设计五部", v: "设计五部" },
      21: { field: "customer.designerName", sourceValue: "400", v: "400" },
      22: { field: "designTichengAmount.isProbationPeriod", sourceValue: "", v: "" },
      23: {
        field: "designTichengAmount.sjf_td",
        sourceValue: 60,
        v: "0.60",
        t: 2,
        s: "Percent_Formatter",
      },
      24: {
        field: "designTichengAmount.sjf_tc",
        sourceValue: 6000,
        v: 6000,
        f: "=(R5*X5)",
        t: 2,
        s: "Number_Formatter",
      },
      25: {
        field: "designTichengAmount.sjf_tc_rate",
        sourceValue: 25,
        v: "0.25",
        t: 2,
        s: "Percent_Formatter",
      },
      26: {
        field: "designTichengAmount.sjf_tc_hf",
        sourceValue: 4500,
        v: "4500",
        t: 2,
        s: "Number_Formatter",
      },
      27: {
        field: "designTichengAmount.sjf_tc_sf",
        sourceValue: 1500,
        v: 1500,
        f: "=(Y5*Z5)",
        t: 2,
        s: "Number_Formatter",
      },
      28: { field: "customer.designLeaderName", sourceValue: "刘元俊", v: "刘元俊" },
      29: {
        field: "designLeaderTichengAmount.sjf_td",
        sourceValue: 3,
        v: "0.03",
        t: 2,
        s: "Percent_Formatter",
      },
      30: {
        field: "designLeaderTichengAmount.sjf_tc",
        sourceValue: 600,
        v: 300,
        f: "=(R5*AD5)",
        t: 2,
        s: "Number_Formatter",
      },
    },
  ],
  departmentId: 2,
  groupType: 2,
  fitUse: "202503",
  houseType: 4,
};

const { sheetData } = json2;
console.log("sheetData", sheetData);

const obj = {
  0: { field: "designRemark", v: "321" },
  1: { field: "id", v: "332472" },
  2: { field: "index", v: "1" },
};

function getValueByField(row, field) {
  for (const key in row) {
    if (row[key].field === field) {
      return row[key].v;
    }
  }
  return null; // 如果找不到对应的 field，返回 null 或者其他默认值
}
console.log(getValueByField(obj, "index")); // 1
console.log(getValueByField(obj, "designRemark")); // ""
console.log(getValueByField(obj, "notExistField")); // null
